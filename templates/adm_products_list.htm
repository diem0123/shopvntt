<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<div class="breadcrumbs ace-save-state" id="breadcrumbs">
	<ul class="breadcrumb">
		<li>
			<i class="ace-icon fa fa-home home-icon"></i>
			<a href="#"><?=$lang['adm_home']?></a>
		</li>

		<li>
			<a href="#"><?=$lang['adm_quanlysanpham']?></a>
		</li>
	</ul><!-- /.breadcrumb -->
</div>
<div class="adm_out" style="text-align:center" >
<div class="adm_common">
<?=$submenu2?>

<form name="f1" >
<input type="hidden" id="vlid" name="vlid" value="">
<input type="hidden" id="vlid1" name="vlid1" value="">
<table border="0" width="98%" cellspacing="0" cellpadding="0" >
		<!--<tr>
			<td width="1" rowspan="3" background="images/bin/line-doc.jpg">
			</td>
			<td width="999" height="1" background="images/bin/line-ngang.jpg">
			</td>
			<td width="1" rowspan="3" background="images/bin/line-doc.jpg">
			</td>
		</tr>-->
		<tr>
			<td width="999">
<table border="0" width="100%">
	<tr>
		<td>
		<table border="0" width="100%" cellpadding="0" cellspacing="0" >
			<tr>
			  <td height="4" align="left" ><span id="err" class="do"></span></td>
			</tr>
		</table>
		<table border="0" width="100%" >
			<tr>
			  <td height="14" class="title" align="left" >
				<button class="admbutton" type="button" name="ct1" value="" onclick="window.open('index.php?act=adm_addproduct&ac=a','Addpropopup','scrollbars=yes,status=yes,toolbar=no,location=0,directories=0,status=yes,menubar=0,resizable=0,width=\'100%\',height=\'100%\'');" ><?=$lang['tl_addpro']?></button>&nbsp;&nbsp;
				<button class="admbutton" type="button" name="ct1" value="" onclick="delit('',document.forms.f1.ck, document.forms.f1.vlid);" ><?=$lang['tl_delpro']?></button>&nbsp;&nbsp;
				<button class="admbutton" type="button" name="ct1" value=""  onclick="window.open('index.php?act=adm_importexcel&ac=a','Addsubcatelementpopup','scrollbars=yes,status=yes,toolbar=no,location=0,directories=0,status=yes,menubar=0,resizable=0,width=500,height=300');">Import</button>&nbsp;&nbsp;
				 <!-- window.open('index.php?act=adm_exportexcel&ac=a','Addsubcatelementpopup','scrollbars=yes,status=yes,toolbar=no,location=0,directories=0,status=yes,menubar=0,resizable=0,width=500,height=200'); 
				 <a href="http://localhost/mtherapyshower/sources/adm_exportexcel.php">Export</a>-->
				 <input type="hidden" id="sessionid" value="<?=$_SESSION['idtypecat']?>" >
				<button class="admbutton" type="button" name="ct1" value=""  onclick="exportlist('',document.forms.f1.ck, document.forms.f1.vlid1);">Export filter</button>
			 </td>
			</tr>
		</table>
		<table border="0" width="100%" cellpadding="0" cellspacing="0" >
			<tr>
			  <td height="10" align="left" ></td>
			</tr>
		</table>		
		</td>
	</tr>
	<tr>
		<td>
		<table id="dynamic-table" class="table table-striped table-bordered table-hover ">
			<thead>
				<tr bgcolor="#EEEEEE">
					<td width="20" class="do" height="25"><input name="allbox" type="checkbox" onclick="checkall(this.form);" title="Check All"></td>
					<th  style="color:red" >ID</th>
					<th  style="color:red"><?=$lang['tl_code']?></th>
					<th  style="color:red"><?=$lang['tl_proname']?> </th>
					<th  style="color:red"><?=$lang['adm_brand']?> </th>
					<th  style="color:red"><?=$lang['tl_datepost']?> </th>
					<th  style="color:red"><?=$lang['tl_dateupdate']?>  </th>
					<th  style="color:red"><?=$lang['tl_status']?> </th>
					<th  style="color:red"><?=$lang['tl_postby']?> </th>
					<th  style="color:red"><?=$lang['tl_action']?> </th>
					
				</tr>
			</thead>
			<tbody>
				<?=$products_list_rs?>
			</tbody>
		</table>
		</td>
	</tr>
	<tr>
		<td height="5"></td>
	</tr>
	<tr>
		<td height="25" align="center">
					<div class="modal-footer no-margin-top">
						<ul class="pagination pull-right no-margin">
							<?=$paging?>
						</ul>
						
					</div>
            	<!-- end box-phantrang -->
		</td>
	</tr>
</table>
</td>
		</tr>
		<!--<tr>
			<td width="999" height="1" background="images/bin/line-ngang.jpg">
			</td>
		</tr>-->
</table>
<table border="0" width="1000" cellspacing="0" cellpadding="0">
	<tr>
		<td height="5" ></td>
	</tr>
</table>
</form>
</div>
</div>
<script language="JavaScript" type="text/javascript" rel="stylesheet">
function getfilterpro() {
			$("#showlibrary:ui-dialog" ).dialog( "destroy" );
			$("#showlibrary").dialog({
					dialogClass: 'flora',
					title: 'L&#7885;c s&#7843;n ph&#7849;m theo chuy&ecirc;n m&#7909;c',
					resizable: false,
					width: 450,
					height : 220,					
					modal: true,
					position: { my:'top',at:'top' }
				});
				//$('.flora.ui-dialog').css({ top: "2px" });
				//$('.flora.ui-dialog').css({ left: "365px" });
				$('.flora.ui-dialog').css({ top: "68px" });
				$('.flora.ui-dialog').css({ left: "562px" });
				//$(".ui-dialog-titlebar").hide();
				//'cat='+$("#cat").val()+'&typecat='+$("#typecat").val()+'&subcat='+$("#subcat").val()+				
				$.ajax({
					url: $("#base_url").val()+'/admin/getboxfilterpro',
					type: 'POST',
					data: 'idcom'+$("#idcom").val(),
					success: function(data) {
					//alert(data);
					$('#showlibrary').html(data);
					//document.getElementById("showlistimg").style.display = "block";
					}
				});

	
}

function getfilterpro2() {
			$("#showlibrary:ui-dialog" ).dialog( "destroy" );
			$("#showlibrary").dialog({
					dialogClass: 'flora',
					title: 'L&#7885;c s&#7843;n ph&#7849;m theo danh m&#7909;c ti&#7871;p th&#7883;',
					resizable: false,
					width: 450,
					height : 220,					
					modal: true,
					position: { my:'top',at:'top' }
				});
				//$('.flora.ui-dialog').css({ top: "2px" });
				//$('.flora.ui-dialog').css({ left: "365px" });
				$('.flora.ui-dialog').css({ top: "68px" });
				$('.flora.ui-dialog').css({ left: "592px" });
				//$(".ui-dialog-titlebar").hide();
				//'cat='+$("#cat").val()+'&typecat='+$("#typecat").val()+'&subcat='+$("#subcat").val()+				
				$.ajax({
					url: $("#base_url").val()+'/admin/getboxfilterpro2',
					type: 'POST',
					data: 'idcom'+$("#idcom").val(),
					success: function(data) {
					//alert(data);
					$('#showlibrary').html(data);
					//document.getElementById("showlistimg").style.display = "block";
					}
				});

	
}


function filterpro(obj,url)
	{				
		//alert(listid.value);
		//alert($('#cat').val());
		document.getElementById("cat1").value = $('#cat').val();
		document.getElementById("typecat1").value = $('#typecat').val();
		document.getElementById("subcat1").value = $('#subcat').val();
		obj.action=url;
		obj.method='post';
		obj.submit();
		//alert(idcom.value);
	}
	
	function delaction(idp,vlid) {
		$.ajax({
			url: 'index.php',
			type: 'POST',
			data: 'act=adm_deleteproduct&ac=d&idp='+idp+'&vlid='+vlid,
			success: function(data) {
				var getdata = $.parseJSON(data);
				if(getdata.mess1 == "success"){
					//alert(getdata.mess2);
					window.location.reload();
				}
				else $('#err').html(getdata.mess2);//alert(getdata.mess2);		
			}
		});	
	}
	
	function delit(idp,listck,listid) {		
	var str1 = "Vui lòng chọn ít nhất 1 sản phẩm!";
	var str2 = "Bạn chắc chắn muốn xóa?";
	if(idp ==""){
		getValueListCheckBox(listck,listid);
		if (listid.value=='') alert(str1);
		else if(confirm(str2)){
			//alert($('#vlid').val());
			var id_list = $('#vlid').val();
			delaction(idp,id_list);
			
		}
	}
	else {
		if(confirm(str2)){
		delaction(idp,'');
		}
	}
	
}

function filtertype() {
	window.location.href='index.php?act=adm_products&cat='+$('#catfilter').val()+'&typecat='+$('#typecat').val()+'&subcat='+$('#subcat').val();	
	}
function changecat() {
	$.ajax({
		url: 'index.php',
		type: 'POST',
		data: 'act=adm_change_cat1&cat='+ $('#catfilter').val(),
		success: function(data) {
			//document.getElementById("sametype").style.display = "block";
			$('#sametype').html(data);			
		}
	});
}	

function changetype() {
	$.ajax({
		url: 'index.php',
		type: 'POST',
		data: 'act=adm_change_type1&typecat='+ $('#typecat').val(),
		success: function(data) {
		//alert(data);
		//document.getElementById("samesubcat").style.display = "block";
		$('#samesubcat').html(data);
		}
	});
}


//export excel
function process(idp,vlid){
	$.ajax({
		url:'index.php',
		type:'POST',
		data:'act=adm_urlexportexcel&ac=ex&idp='+idp+'&vlid='+vlid,
		success: function(data) {
				var getdata = $.parseJSON(data);
				if(getdata.mess1 == "success"){
					alert(getdata.mess2);
					//window.location.reload();
				}
				else{
					alert("khong thanh cong");
					$('#err').html(getdata.mess2);//alert(getdata.mess2);
				} 		
			}
		});
	
	}
function exportlist(idp,listcheck,listidp) {		
	var str1 = "Bạn xuất ra toàn bộ dữ liệu";
	var str2 = "Bạn muốn xuất file excel dựa vao các fill đã chọn";
	var str3 = "Bạn muốn xuất dữ liệu dựa vào các mục đã chọn";
	var idtypecat   = $('#sessionid').val();
		if(idp ==""){
			getValueListCheckBox(listcheck,listidp);
			if (listidp.value=='' && idtypecat =='') {alert(str1);window.open('/lacoco/sources/adm_exportexcellist.php');}
			else if(listidp.value ==''&& idtypecat !=''){alert(str3);window.open('/lacoco/sources/adm_exportexcellist.php');}
			else if(confirm(str2)){
				//alert($('#vlid').val());
				var id_list = $('#vlid1').val();
				process(idp,id_list);
				//var url_link = '<?php echo $urllink;?>';			
				//alert(url_link);
				window.open('/lacoco/sources/adm_exportexcellist.php');
			}
		}
		


}
	
</script>