<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>&#7842;nh c&ugrave;ng s&#7843;n ph&#7849;m </title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="css/wstyle.css" />
<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="js/webtoolkit.aim.js" ></script>
</head>
<body bgcolor="#EEEEEE" marginwidth="0" marginheight="0" topmargin="0" leftmargin="0" >
<table border="0" width="100%" cellspacing="0" cellpadding="0" bgcolor="#EEEEEE">
	<tr>
		<td width="404" valign="top">
		<table border="0" cellpadding="0" cellspacing="0" style="padding: 10px;"><tr><td>
<form action="index.php?act=upload_images" method="post"  enctype="multipart/form-data" name="f1" id="f1"  onSubmit="return AIM.submit(this, {'onStart' : startCallback, 'onComplete' : completeCallback})" >
<input type="hidden" name="idp" id="idp" value="<?=$idp?>">
<input type="hidden" name="idc" id="idc" value="<?=$idc?>">
<input type="hidden" name="n" id="n" value="1">
<table width="380" border="0" cellpadding="0" cellspacing="0" style="background-color: #F7F7F7; border: 2px solid #FFFFFF; padding: 5px;">
  <tr>
    <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" width="300" height="300" align="center"><img class="border_rounded" src="images/bin/<?=$idc?>/<?=$image_display?>" width="<?=$w?>" height="<?=$h?>" alt="showimg" id="change_img" /></td>
  </tr>
</table>
<span style="font-family: arial, verdana, helvetica; font-size: 11px; font-weight: bold;">
Upload  &#7843;nh cùng sản phẩm:</span><br />

<br />
<span  class="require" id="errorLogo"></span>
<table width="380" border="0" cellpadding="0" cellspacing="0" style="background-color: #F7F7F7; border: 2px solid #FFFFFF; padding: 5px;">
 <tr>
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" width="288" height="20">
  <div id="mess1" class="do"></div>
	<input name="img1" type="file" size="40" style="font-family: arial, verdana, helvetica; font-size: 11px; width: 100%;"></td>
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" width="16" height="20">
	<img src="images/icon_add.gif" alt="Them dong" title="Th&ecirc;m d&ograve;ng upload" id="add1" onClick="addremoveup(1,'+');" style="cursor:pointer"></td>
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" width="42" height="20">&nbsp;
	</td>
 </tr>
 <tr>
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" width="288" height="20">
  <span style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;">Nhập tên sản phẩm 1 </span>
	<input name="text1" type="input" size="40" style="font-family: arial, verdana, helvetica; font-size: 11px; width: 90%;"></td>
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" width="16" height="20">
	</td>
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" width="42" height="20">&nbsp;
	</td>
 </tr> 
 <tr id="up1" style="display:none">
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" height="20" width="288" >
  <div id="mess2" class="do"></div>
	<input name="img2" id="img2" type="file" size="40" style="display:none;font-family: arial, verdana, helvetica; font-size: 11px; width: 100%;" disabled ></td>
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" height="20" width="16">
	<img src="images/icon_remove.gif" alt="Bot dong" title="B&#7887; b&#7899;t d&ograve;ng upload" id="remove2" onClick="addremoveup(2,'-');" style="cursor:pointer"></td>
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" height="20" width="42">
	<img src="images/icon_add.gif" alt="them dong" title="Th&ecirc;m d&ograve;ng upload" id="add2" onClick="addremoveup(2,'+');" style="cursor:pointer"></td>
 </tr>
 <tr id="tn1" style="display:none" >
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" width="288" height="20">
  <span style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;">Nhập tên sản phẩm 2 </span>
	<input name="text2" type="input" size="40" style="font-family: arial, verdana, helvetica; font-size: 11px; width: 90%;"></td>
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" width="16" height="20">
	</td>
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" width="42" height="20">&nbsp;
	</td>
 </tr> 
 <tr id="up2" style="display:none">
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" height="20" width="288">
  <div id="mess3" class="do"></div>
	<input name="img3" id="img3" type="file" size="40" style="display:none;font-family: arial, verdana, helvetica; font-size: 11px; width: 100%;" disabled ></td>
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" height="20" width="16">
	<img src="images/icon_remove.gif" alt="bot dong" title="B&#7887; b&#7899;t d&ograve;ng upload" id="remove3" onClick="addremoveup(3,'-');" style="cursor:pointer"></td>
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" height="20" width="42">&nbsp;
	</td>
 </tr>
 <tr id="tn2" style="display:none">
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" width="288" height="20">
  <span style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;">Nhập tên sản phẩm 3 </span>
	<input name="text3" type="input" size="40" style="font-family: arial, verdana, helvetica; font-size: 11px; width: 90%;"></td>
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" width="16" height="20">
	</td>
  <td style="padding-bottom: 2px; padding-top: 0px; font-family: arial, verdana, helvetica; font-size: 11px;" width="42" height="20">&nbsp;
	</td>
 </tr>
</table>
<table width="380" border="0" cellpadding="0" cellspacing="0" style="margin-top: 10px;">
<tr>
	<td>
	<div align="left" style="padding-top: 5px;"><input type="submit" value="  Upload  " name="uplibrary" style="font-size: 12px;" /></div>
	</td>
</tr>
</table>
</form>
</td></tr>
</table>
		</td>
		<td valign="top">
		<div id="del_err"></div>
		<div id="text_err"></div>
		<div id="showlibrary"></div>
		</td>
	</tr>
</table>
<script language="JavaScript" type="text/javascript">
function getlistimage(page) {
	$.ajax({
		url: 'index.php',
		type: 'POST',
		data: 'act=getimg_link&idp='+$("#idp").val()+'&page='+ page,
		success: function(data) {
		//alert(data);
		$('#showlibrary').html(data);
		//document.getElementById("showlistimg").style.display = "block";
		}
	});
}

function addremoveup(bt,str) {
	if(bt==1 && str=="+") {
	$('#add1').attr("style","display:none");	
	$('#add2').attr("style","display:block;cursor:pointer;");
	$('#remove2').attr("style","display:block;cursor:pointer;");	
	$('#up1').attr("style","display:table-row");
	$('#tn1').attr("style","display:table-row");
	$('#img2').attr("style","display:block;font-family: arial, verdana, helvetica; font-size: 11px; width: 100%;");
	$('#img2').removeAttr("disabled");	
	//document.f1.img2.disabled = false;
	$('#up2').attr("style","display:none");
	$('#tn2').attr("style","display:none");
	$('#img3').attr("style","display:none");
	document.getElementById('n').value = parseInt($('#n').val())+1;
	}
	else if(bt==2 && str=="+") {
	$('#add1').attr("style","display:none");
	$('#add2').attr("style","display:none");
	$('#remove2').attr("style","display:none");
	$('#remove3').attr("style","display:block;cursor:pointer;");	
	$('#up1').attr("style","display:table-row");
	$('#tn1').attr("style","display:table-row");
	$('#img2').attr("style","display:block;font-family: arial, verdana, helvetica; font-size: 11px; width: 100%;");
	//document.f1.img2.disabled = false;
	//$('#img2').attr("disabled", false);
	$('#img2').removeAttr("disabled");
	$('#up2').attr("style","display:table-row");
	$('#tn2').attr("style","display:table-row");
	$('#img3').attr("style","display:block;font-family: arial, verdana, helvetica; font-size: 11px; width: 100%;");
	//document.f1.img3.disabled = false;
	//$('#img3').attr("disabled", false);
	$('#img3').removeAttr("disabled");
	document.getElementById('n').value = parseInt($('#n').val())+1;
	}
	else if(bt==2 && str=="-") {
	$('#add1').attr("style","display:block;cursor:pointer;");
	$('#up1').attr("style","display:none");
	$('#tn1').attr("style","display:none");
	//document.f1.img2.disabled = true;
	$('#img2').attr("disabled", true);
	$('#img2').attr("style","display:none");
	$('#up2').attr("style","display:none");
	$('#tn2').attr("style","display:none");
	//document.f1.img3.disabled = true;
	$('#img3').attr("disabled", true);
	$('#img3').attr("style","display:none");
	document.getElementById('n').value = parseInt($('#n').val())-1;
	}
	else if(bt==3 && str=="-") {
	$('#add1').attr("style","display:none");
	$('#add2').attr("style","display:block;cursor:pointer;");
	$('#remove2').attr("style","display:block;cursor:pointer;");
	$('#img2').attr("style","display:block;font-family: arial, verdana, helvetica; font-size: 11px; width: 100%;");
	$('#up1').attr("style","display:table-row");
	$('#tn1').attr("style","display:table-row");
	//document.f1.img3.disabled = true;
	$('#img3').attr("disabled", true);
	$('#img3').attr("style","display:none");
	$('#up2').attr("style","display:none");
	$('#tn2').attr("style","display:none");
	document.getElementById('n').value = parseInt($('#n').val())-1;
	}

}
/*
$(function(){
		var btnUpload=$('#btUpload');
		var status=$('#errorLogo');
		new AjaxUpload(btnUpload, {
			action: $("#base_url").val()+'/admin/uploadlibrary',
			name: 'uploadfile',
			onSubmit: function(file, ext){
				 if (! (ext && /^(jpg|png|gif)$/.test(ext))){ 
					status.text('Invalid file type. Please check');
					return false;
				}
				status.text('Uploading...');
			},
			onComplete: function(file, response){
				status.text('');
				if(response==="success"){
					status.html('Upload success.');
				} else{
					status.text(response);
				}
			}
		});
	});
*/
getlistimage(0);
$(function(){
 var frm = $('#f1');
// content_type: "multipart/form-data",
 //frm.submit(function () {
  $('#uplibrary').click(function () {
        $.ajax({
            type: frm.attr('method'),
            url: frm.attr('action'),            
            enctype: "multipart/form-data",
            data: frm.serialize(),
            success: function (data) {
            // alert(data);
            $('#showlibrary').html(data);
            }
        });       
    });
});

		function startCallback() {
			// make something useful before submit (onStart)
			return true;
		}
 
		function completeCallback(response) {
			// make something useful after (onComplete)
			//document.getElementById('nr').innerHTML = parseInt(document.getElementById('nr').innerHTML) + 1;
			//document.getElementById('r').innerHTML = response;
			//alert(response);			
			var getData = $.parseJSON(response);			
			$('#mess1').html(getData.mess1);
			$('#mess2').html(getData.mess2);
			$('#mess3').html(getData.mess3);			
			getlistimage(0);
			
		}
		
	function delimage(id,imgname) {
	$.ajax({
		url: 'index.php',
		type: 'POST',
		data: 'act=adm_delimage&id='+id+'&imgname='+imgname,
		success: function(data) {
		//alert(data);
		var getData = $.parseJSON(data);
		if(getData.mess1 == "success") window.location.reload();
		else $('#del_err').html(getData.mess2);
		
		}
	});
}
function edittext(id) {
var textname = "#text"+id;
	$.ajax({
		url: 'index.php',
		type: 'POST',
		data: 'act=adm_edittext&id='+id+'&textname='+$(textname).val(),
		success: function(data) {
		//alert(data);
		var getData = $.parseJSON(data);
		if(getData.mess1 == "success") window.location.reload();
		else $('#text_err').html(getData.mess2);
		
		}
	});
}
</script>
</body>
</html>